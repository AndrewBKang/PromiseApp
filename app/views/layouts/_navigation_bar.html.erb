<% if user_signed_in?%>
<header class="nav clearfix">
	<div class="navbar">
		<ul class="left-menu">
			<li><%= link_to("logo", resolutions_url) %></li>
			<li>
				<a href="#">
					friend requests 
					<% if current_user.friend_requests.length > 0 %>
						<strong class="badge"><%= current_user.friend_requests.length %></strong> 
					<% end %>
				</a>
				<ul class="nav-dropdown bubble clearfix">
					<% current_user.friend_requests.each do |request| %>
						<li>
							<div class="name"><%= link_to(request[:friendname],user_url(request[:user_id])) %></div>
							<%= button_to "Accept", friendship_url(request[:id]), method: "put", remote:true, class:"new_friend" %>
						</li>
					<% end %>
				</ul>
			</li>
			<li>
				<% note_count = current_user.notifications_count %>
				<a class="notification-tab" data-remote="true" href="<%= read_url(note_count) %>">
					notifications
					<% if note_count > 0 %>
						<strong class="badge"><%= note_count %></strong>
					<% end %>
				</a>
				<ul class="nav-dropdown bubble clearfix">
					<% current_user.notifications.reverse.each do |note| %>
						<li>
							<div class="message">
								<%= link_to(note.message,user_url(note.activity.user_id)) %>
							</div>
						</li>
					<% end %>
				</ul>
			</li>
		</ul>
		
		<div class="search-bar">
			<input class="searchbar" value="searchbar">
		</div>
		
		<ul class="right-menu">
			<li><a href="#">home</a></li>
			<li><%= link_to("profile", profile_url) %><li>
			<li><%= link_to("logout", destroy_user_session_url, method: :delete)%></li>
		</ul>
	</div>
</header>

<% end %>

<script>
	
	$('.button_to').on("ajax:success", function(event){
		$(event.target).parent().addClass('friended');
		var $badge = $('.badge');
		($badge.text() == 1) ? $badge.addClass('friended') : $badge.text($badge.text()-1)
	});
	
	$('.notification-tab').on("ajax:success", function(){
		$('.badge').hide();
	});
	
</script>