</div>
<div class="body-container">
	<%= render :partial => 'profile_navbar' %>
	<%= render :partial => 'shared/window_container', locals: {window_type: "My Resolutions"} %>
</div>

<script>
	var page = 1;
	var url = "profile/?page=";
	var loading = false;
	function nearBottomOfPage() {
	  return $(".mini-window-scroll-container").scrollTop() > 						$('.scroll-content').height() - 						$('.mini-window-scroll-container').height() - 200;
	}
	$('.mini-window-scroll-container').scroll(function(){
		if(nearBottomOfPage() && !loading && (page <= <%= @resolutions.total_pages %>) ) {
	    loading=true;
	    page += 1;
			$.ajaxSetup({
				beforeSend: function(){
					$('.loader-container').show();
				},
				complete:function(){
					$('.loader-container').hide();
				}
			});
	    $.ajax({url: url + page}).done(
				function(data) {
					loading=false
					$('.resolution-list').append(data)
				}
			) 
	  }
	});

	$('#new_resolution').on("ajax:success", function(event,data){
		$('.resolution-list').prepend(data);
		$('#resolution_title').val('');
		$('#resolution_body').val('');
		$('.resolution_form').hide();
	});
	
	$('#new_resolution').on("ajax:success", function(event,data){
		$('.resolution-list').prepend(data);
		$('#user_profile_photo').val('');
		$('.new_pic_form').hide();
	});

</script>